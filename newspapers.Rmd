---
title: "newspapers"
author: "Elise Hachfeld"
date: "2024-12-08"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(httr2)
library(jsonlite)
```

```{r}
base <- "https://www.loc.gov/collections/chronicling-america/"

params <-  list(dl = "page",
                start_date = "1941-12-01",
                end_date = "1941-12-31",
                location_state = "Minnesota",
                fa = "language:english",
                front_pages_only = "true",
                fo = "json",
                searchType = "advanced")

req <- request(base) |>
  req_url_query(!!!params)

response <- req |> 
  req_retry(max_tries = 100,
            backoff = ~10) |>
  req_perform()


resp_json_list <- resp_body_json(response)
head(resp_json_list, 2)

resp_json_df <- resp_body_json(response, simplifyVector = TRUE)
head(resp_json_df)

resp_json_df <- janitor::row_to_names(resp_json_df, 1)
head(resp_json_df)
```